import lightgbm as lgb
from dataset_builder import DatasetReader

dataset = DatasetReader('dataset')

trojan = dataset.read_data['trojan']
rootkit = dataset.read_data['rootkit']
backdoor = dataset.read_data['backdoor']
#benign = dataset.read_data['benign']

d_train = lgb.Dataset(x_train, label = y_train)
params = {}
params['learning_rate'] = 0.003
params['boosting_type'] = 'gbdt'
params['objective'] = 'multiclass'
params['num_class'] = 3
params['metric'] = 'binary_logloss'
params['sub_feature'] = 0.5
params['num_leaves'] = 10
params['min_data'] = 50
params['max_depth'] = 10
params['device'] = 'gpu'

clf = lgb.train(params, d_train, 100)
y_pred = clf.predict(x_test)